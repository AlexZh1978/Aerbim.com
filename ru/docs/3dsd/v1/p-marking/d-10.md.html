<h1>Команда «Создание формата»</h1>
<p><strong>Назначение:</strong> создание формат маркировки на основе тегов. При маркировании элементов эти теги будут заменены на конкретные строковые значения.</p>
<p align='center'>
<img alt='D 10 01' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-01.png' />
<br/>
Рис. 1. Запуск команды «Создание формата»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Для запуска команды нажмите кнопку «Создание формата», которая расположена в разворачиваемой части на панели инструментов «Маркировка» вкладки «3D Security Designer». После этого отобразится окно «Создание формата маркировки». </p>
<p align='center'>
<img alt='D 10 02' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-02.png' />
<br/>
Рис. 2. Окно «Создание формата маркировки»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Для создания формата маркировки предусмотрено следующие теги, которые могут быть скомбинированы в произвольной последовательности: </p>
<ul>
<li>[Имя цепи] позволяет отобразить имя, присваиваемое каждой цепи 3D Security Designer.</li>
<li>[Счётчик] позволяет нумеровать элементы цепи. Механизм нумерация может учитывать такие нюансы, как вложенность семейств Revit и резервирование нескольких номеров для семейств с несколькими логическими адресами в цепи. См. подробнее в статье Command «Создание формата».</li>
<li>[Поле пользователя] позволяет отобразить произвольную информацию пользователя в составе маркировки. Поле пользователя заполняется на этапе создания/изменения цепей.</li>
<li>[Параметр Revit] позволяет отобразить в маркировке информацию из параметров Revit, определённых для маркируемого экземпляра семейства.</li>
<li>[Разделитель] служит для визуального разделения частей маркировки. Заменяется на выбранный символ: точку, тире, слэш и т.д.</li>
<li>[Текст] позволяет отобразить произвольный текст из нескольких символов. В отличии от [Поле пользователя] заполнения на этапе создания/редактирования цепи не требуется.</li>
</ul>
<p style="text-indent: 15px; line-height: 1 em;"> Например, формат маркировки из трёх тегов [Имя цепи][Разделитель][Счётчик] может породить для элемента маркировку «Л-007». </p>
<p style="text-indent: 15px; line-height: 1 em;"> Управляющие элементы окна «Создание формата маркировки» отвечают за следующий функционал: </p>
<ol>
<li>Текстовое поле «Имя формата» позволяет задать имя формата. Имя формата должно быть уникальным в пределах текущего документа. Если будет задано не уникальное имя формата, то отобразится сообщение об ошибке, текстовое поле подсветится красным цветом, а кнопка «Создать формат» станет не активной.</li>
</ol>
<p align='center'>
<img alt='D 10 03 A' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-03-a.png' />
<img alt='D 10 03 B' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-03-b.png' />
<br/>
Рис. 3. Ошибка при не уникальном имени формата
</p>
<ol start="2">
<li>Список «Структура формата» содержит последовательность тегов, собственно и задающих структуру формата. Теги ответственны как за отображение содержательной информации в маркировке элемента (например, имя цепи), так и за символы-разделители, вводимые для удобного визуального восприятия маркировки (далее разделители). Список может содержать не более девяти тегов с учетом разделителей и не более пяти тегов без учета разделителей. При нарушении указанных условий текст напоминания о структуре формата подсветится красным цветом.</li>
</ol>
<p align='center'>
<img alt='D 10 04' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-04.png' />
<br/>
Рис. 4. Напоминание о структуре формата
</p>
 3. Для ускорения процесса новый формат можно создать на основе структуры ранее созданного формата. Для этого предусмотрен флажок «На основе существующего формата». Если флажок установлен, то в списке «Структура формата» отобразятся теги, входящие в структуру ранее созданного формата, который был выбран в выпадающем списке. На рис. 2 выше создаётся новый формата с именем «test_format» на основе формата с именем «Alex», содержащем теги [Имя цепи], [Счётчик]. 
 4. Выпадающий список «На основе существующего формата» позволяет выбрать существующий в документе формат маркировки для создания на его основе нового формата. Каждый пункт выпадающего списка содержит через двоеточие имя и структуру существующего формата. 
 5. Кнопка «Добавить тег [Имя цепи]» добавляет тег [Имя цепи] в создаваемый формат маркировки. Данный тег не имеет параметров. Само имя цепи вводится на этапе создания/изменения цепи. 
 6. Кнопка «Добавить тег [Счетчик]» открывает окно «Параметры тега [Счетчик]» для задания параметров и вставки тега в создаваемый формат. В формате маркировки может присутствовать только один счётчик. 
<p align='center'>
<img alt='D 10 05' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-05.png' />
<br/>
Рис. 5. Окно «Параметры тега [Счетчик]»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Окно «Параметры тега [Счетчик]» имеет следующие управляющие элементы: </p>
<ul>
<li>Поле «Минимум» — начальное значение счетчика, соответствующее первому по порядку элементу в цепи.</li>
<li>Поле «Максимум» — максимальное значение счетчика, предусмотренное форматом маркировки. При его превышении пользователь получает оповещение.</li>
<li>Поле «Шаг приращения» — приращение счетчика при переходе к следующему маркируемому элементу в цепи. В настоящей версии всегда равен единице.</li>
<li>Поле «Количество цифр» — количество цифр в строковом представлении счетчика. При необходимости к строковому представлению счётчика спереди добавляются символы «0». Например, число 3 в данном поле дает для значения счетчика 7 строковое представление «007».</li>
<li>Кнопка «Добавить тег» добавляет тег [Счетчик] в структуру формата. Параметры тега отображаются в квадратных скобках в указанном порядке. Например, в теге [Счетчик 1 3 1 3] параметр «Минимум» равен 1, «Максимум» равен 3, «Шаг приращения» равен 1, «Количество цифр» равно 3.</li>
<li>Кнопка «Отмена» отменяет добавление тега [Счетчик].</li>
</ul>
<ol start="7">
<li>Кнопка «Добавить тег [Поле пользователя]» открывает окно «Параметры тега [Поле пользователя]» для задания параметров и вставки тега в создаваемый формат. Формат маркировки может содержать несколько полей пользователя с разными именами. Значения для полей пользователя вводятся на этапе создании/изменения цепей.</li>
</ol>
<p align='center'>
<img alt='D 10 06' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-06.png' />
<br/>
Рис. 6. Окно «Параметры тега [Поле пользователя]»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Окно «Параметры тега [Поле пользователя]» имеет следующие управляющие элементы: </p>
<ul>
<li>«Имя поля пользователя» позволяет задать имя для поля пользователя. Данное имя будет фигурировать в запросе на ввод значения. Далее, при создании или изменении маркированной цепи и выборе данного создаваемого формата, для этого имени будет присвоено значение.</li>
<li>Кнопка «Добавить тег» добавляет тег [Поле пользователя] в структуру формата. Параметр «Имя поля пользователя» отображается в квадратных скобках. Например, [Поле пользователя ‘БЦО’] описывает поле ‘БЦО’. Пример присвоения значения полю пользователя ‘БЦО’ уже на этапе создания новой цепи см. на рис. 10 ниже.</li>
<li>Кнопка «Отмена» отменяет добавление тега [Поле пользователя].</li>
</ul>
<ol start="8">
<li>Кнопка «Добавить тег [Параметр Revit]» открывает окно «Параметры тега [Параметр Revit]» для задания параметров и вставки тега в создаваемый формат.</li>
</ol>
<p align='center'>
<img alt='D 10 07' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-07.png' />
<br/>
Рис. 7. Окно «Параметры тега [Параметр Revit]»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Окно «Параметры тега [Параметр Revit]» имеет следующие управляющие элементы: </p>
<ul>
<li>Текстовое поле «Имя параметра Revit» позволяет задать имя параметра Revit, значение которого будет отображаться в маркировке. Если в элементе (семействе) несколько параметров с одинаковым именем, то приоритет отображения будет у параметра экземпляра. Если в элементе (семействе) отсутствует параметр с указанным именем, то вместо значения отобразится символ «?».</li>
<li>Кнопка «Добавить тег» добавляет тег [Параметр Revit] в список «Структура формата» в окне «Создание формата маркировки». Например, [Параметр Revit ‘Марка’].</li>
<li>Кнопка «Отмена» отменяет добавление тега [Параметр Revit] в структуру создаваемого формата.</li>
</ul>
<p>9 Кнопка «Добавить тег [Разделитель]» отображает окно «Параметры тега [Разделитель]» и позволяет выбрать конкретный разделитель.</p>
<p align='center'>
<img alt='D 10 08' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-08.png' />
<br/>
Рис. 8. Окно «Параметры тега [Разделитель]»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Окно «Параметры тега [Разделитель]» имеет следующие управляющие элементы: </p>
* Выпадающий список «Выбрать разделитель» позволяет выбрать один из предопределенных разделителей: слэш, дефис, двоеточие и т.д. 
* Кнопка «Добавить тег» добавляет тег «[Разделитель]» в список «Структура формата» в родительском окне «Создание формата маркировки». Например, в виде [Разделитель ‘/’]. 
* Кнопка «Отмена» отменяет добавление тега «[Разделитель]» в структуру создаваемого формата. 
<ol start="10">
<li>Кнопка «Добавить тег [Текст]» открывает окно «Параметры тега [Текст]» и позволяет ввести текст для тега [Текст] и добавить тег в структуру формата.</li>
</ol>
<p align='center'>
<img alt='D 10 09' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-09.png' />
<br/>
Рис. 9. Окно «Параметры тега [Текст]»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Окно «Параметры тега [Текст]» имеет следующие управляющие элементы: </p>
<ul>
<li>Поле «Текст» позволяет задать текст (не более 10 символов), который будет отражаться в маркировке.</li>
<li>Кнопка «Добавить тег» добавляет тег «[Текст]» в список «Структура формата» в родительском окне «Создание формата маркировки». Например, в виде [Текст ‘АБВ’].</li>
<li>Кнопка «Отмена» отменяет добавление тега «[Текст]» в структуру создаваемого формата.</li>
</ul>
<ol start="11">
<li>Группа кнопок, позволяющая местоположением тегов в структуре создаваемого формата, редактировать и удалять теги.</li>
</ol>
<ul>
<li><img alt='D 10 Btn A' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-btn-a.png' />позволяет отредактировать параметры выбранного тега, кроме тега [Имя цепи], который параметров не имеет.</li>
<li><img alt='D 10 Btn B' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-btn-b.png' />позволяет удалить выбранный тег из структуры формата.</li>
<li><img alt='D 10 Btn C' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-btn-c.png' />позволяет переместить выбранный тег вверх (одно нажатие кнопки перемещает тег на одну позицию вверх).</li>
<li><img alt='D 10 Btn D' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-btn-d.png' />позволяет переместить выбранный тег вниз (одно нажатие кнопки перемещает тег на одну позицию вниз).</li>
</ul>
<ol start="12">
<li>Поле «Представление формата» отражает текущий вид редактируемого формата маркировки. В поле через двоеточие приведены имя и структуру формата. Если имя ещё не задано, то оно в представлении заменяется символом «?». Теги, собственно задающие структуру формата, отображаются следующим образом:</li>
</ol>
<ul>
<li>Тег [Имя цепи] отображается как строка «[Имя цепи]».</li>
<li>Тег [Счётчик] отображается как число, соответствующее минимальному значению счётчика, например «001».</li>
<li>Тег [Поле пользователя 'Имя_поля'] отображается как «[U:Имя_поля]».</li>
<li>Тег [Параметр Revit 'Имя_параметра'] отображается как «[R:Имя_параметра]».</li>
<li>[Разделитель] заменяется на соответствующий символ разделителя.</li>
<li>[Текст] заменяется на соответствующий текст.</li>
</ul>
<ol start="13">
<li>Кнопка «Создать формат» создает в текущем документе новый формат с заданным именем и структурой и закрывает окно «Создание формата маркировки».
14 Кнопка «Отмена» отменяет команду «Создание формата» и закрывает окно «Создание структуры формата».</li>
</ol>
<p style="text-indent: 15px; line-height: 1 em;"> После задания в окне «Создание формата маркировки» имени формата, структуры формата и нажатия кнопки «Создать формат» в текущем документе создаётся новый формат маркировки. Впоследствии его можно увидеть и выбрать в выпадающем списке форматов маркировки «Выбор формата» при создании или редактировании маркированных цепей (в нашем примере формат с именем «test_format»). </p>
<p align='center'>
<img alt='D 10 10' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-10.png' />
<br/>
Рис. 10. Пример использования формата маркировки. Присвоение значения полю пользователя ‘БЦО’ на этапе создания новой цепи
</p>
<p style="text-indent: 15px; line-height: 1 em;"> В случае сбоя команды будет выведено соответствующее сообщение, при этом создания формата маркировки не произойдет. </p>
<p align='center'>
<img alt='D 10 11' src='/upload/ru/docs/3dsd/v1/p-marking/d-10-img/d-10-11.png' />
<br/>
Рис. 11. Сообщение о сбое
</p>
