<h1>Команда «Добавление элементов»</h1>
<p><strong>Назначение:</strong> добавление элементов (семейств) в существующую цепь служит для вставки элементов в указанное место уже существующей цепи с автоматическим обновлением порядка, маркировки и визуального представления маркировки элементов в цепи.</p>
<p align='center'>
<img alt='D 05 01' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-01.png' /> 
<br/>
Рис. 1. Запуск команды «Добавление элементов»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Для запуска команды нажмите кнопку «Добавление элементов» в группе «Действия с группой элементов» на панели инструментов «Маркировка» вкладки «3D Security Designer». Если в текущем документе ранее не было создано ни одной цепи, то отобразится окно, информирующее об этом пользователя, </p>
<p align='center'>
<img alt='D 05 02' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-02.png' />
<br/>
Рис. 2. Предупреждение об отсутствии цепей
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Иначе отобразится окно «Добавление элементов к цепи». </p>
<p align='center'>
<img alt='Add Elem Wnd New' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/AddElemWnd_new.png' />
<br/>
Рис. 3. Окно «Добавление элементов к цепи»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Управляющие элементы окна отвечают за следующий функционал: </p>
<ol>
<li>Список «Выбор цепи» позволяет выбрать одну из ранее созданных в документе цепей для добавления к ней элементов (семейств).</li>
<li>Поле «Формат маркировки цепи» даёт представление о формате маркировки для выбранной цепи. Поле содержит через двоеточие имя формата и структуру формата.</li>
<li>Если флажок «Добавить перед указанным элементом цепи» установлен, то добавление элементов будет происходить перед указанным элементом в цепи. Если нет, то после.</li>
<li>Таблица «Информация о цепи» содержит количественную информацию о выбранной цепи, включая поля:</li>
</ol>
<ul>
<li>«Количество элементов (семейств)» — количество элементов (семейств) в цепи, включая вложенные.</li>
<li>«Макс. количество адресов формата» — максимальное количество номеров, предусмотренное форматом маркировки.</li>
<li>«Количество незанятых адресов» — количество неиспользованных номеров, которые можно присвоить элементам, не нарушая требования формата маркировки.</li>
<li>«Количество адресов за пределами формата» — количество номеров элементов, лежащих за пределами, предусмотренными форматом маркировки.</li>
</ul>
<ol start="5">
<li>Кнопка «Добавить элементы» запускает выбор элементов для добавления в выбранную цепи.</li>
<li>Кнопка «Отмена» отменяет команду «Добавление элементов» и закрывает окно «Добавление элементов к цепи».</li>
</ol>
<p style="text-indent: 15px; line-height: 1 em;"> После настройки логики работы команды «Добавление элементов» в окне «Добавление элементов к цепи» и нажатия кнопки «Добавить элементы» запускается процесс добавления элементов к выбранной цепи. </p>
<p style="text-indent: 15px; line-height: 1 em;"> Если требуется добавить элементы, находящиеся на разных видах, то перед запуском этой команды необходимо предварительно открыть данные виды, чтобы по ним можно было переключаться в процессе работы команды.  При этом все элементы (если они присутствуют на виде), входящие в цепь, подсветятся зеленым цветом на текущем виде. В строке состояния появиться запрос «Выделите элемент в цепи относительно которого будут добавляться новые элементы». После выбора этого элемента, он подсветится красным цветом и в строке состояния появится запрос «Выделите элементы, которые будут добавлены в цепь». </p>
<p style="text-indent: 15px; line-height: 1 em;"> Далее следует выбрать элементы, которые необходимо добавить в выбранную цепь и нажать ОДИН раз клавишу «Esc» на клавиатуре (нажатие более одного раза клавиши «Esc» приведет к отмене работы команды), чтобы завершить выбор. В результате к цепи добавляются новые элементы, с автоматическим обновлением порядка, маркировки и визуального представления маркировки элементов в цепи. Все элементы перестроенной цепи подсветятся. </p>
<p style="text-indent: 15px; line-height: 1 em;"> Следует помнить, что добавлять можно только семейства определенных категорий. Добавляемые семейства должны быть адаптированы к работе с надстройкой «3D Security Designer». </p>
<p style="text-indent: 15px; line-height: 1 em;"> <b> ВАЖНО: </b> для ускорения выполнения команды - визуализация маркировки у элементов после изменения цепи, будет отображена только на тех видах, где она была до выполнения команды. Это значит, что если визуализации у элементов изменяемой цепи на каких-либо видах не было, то ее не будет на этих видах и после выполнения команды. Исключение составляют только виды, на которых были выбраны добавляемые элементы.  маркировка у которых будет визуализирована в соответствии шагом визуализации даже, если на этих видах до выполнения команды не было ни одного элемента изменяемой цепи с визуализированной маркировкой. При этом логика работы команды такова, что если элементы были добавлены из других цепей и у них была визуализирована маркировка, то, несмотря на значение шага визуализации у изменяемой цепи (к которой добавляются элементы), маркировка у добавляемых элементов останется визуализированной, но с новыми значениями формата маркировки. </p>
<p style="text-indent: 15px; line-height: 1 em;"> Пример работы команды </p>
<p align='center'>
<img alt='D 05 04' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-04.png' />
<br/>
Рис. 4. До вызова команды «Добавление элементов»
</p>
<p align='center'>
<img alt='D 05 05' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-05.png' />
<br/>
Рис. 5. После выбора цепи для добавления элементов
</p>
<p align='center'>
<img alt='D 05 06' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-06.png' />
<br/>
Рис. 6. Запрос на выделение элемента
</p>
<p align='center'>
<img alt='D 05 07' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-07.png' />
<br/>
Рис. 7. После выбора элемента, относительно которого будут добавляться новые элементы в цепь
</p>
<p align='center'>
<img alt='D 05 08' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-08.png' />
<br/>
Рис. 8. Запрос на добавление элементов
</p>
<p align='center'>
<img alt='D 05 09' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-09.png' />
<br/>
Рис. 9. Выделение элементов для последующего добавления в цепь
</p>
<p align='center'>
<img alt='D 05 10' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-10.png' />
<br/>
Рис. 10. Результат выполнения команды «Добавление элементов» с учетом ранее сделанных настроек в окне «Добавление элементов к цепи»
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Возможны следующие неоднозначности при работе команды «Добавление элементов»: </p>
<p style="text-indent: 15px; line-height: 1 em;"> Если в процессе добавления элементов в цепь в выбранных элементах оказались элементы, которые ранее были включены в другие цепи, то отобразится соответствующее информационное окно, определяющее дальнейшие действия пользователя. При этом в окне появится информация о количестве элементов и именах цепей, по которым возникла неоднозначность. В случае продолжения работы команды автоматически изменится нумерация элементов и визуальное представление маркировки в затронутых цепях (если визуализация для них была предусмотрена ранее) в соответствии с последними сделанными настройками в окне «Настройки визуализации маркировки». </p>
<p align='center'>
<img alt='D 05 11' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-11.png' />
<br/>
Рис. 11. Устранение коллизии
</p>
<p style="text-indent: 15px; line-height: 1 em;"> Если в процессе добавления элементов в цепь количество выбранных элементов превышает количество, предусмотренное форматом маркировки, то отобразится соответствующее информационное окно, определяющее дальнейшие действия пользователя. При этом в окне появится информация о количестве фактически выбранных элементов и максимальном количестве элементов, определенном форматом маркировки. </p>
<p align='center'>
<img alt='D 05 12' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-12.png' />
<br/>
Рис. 12. Устранение коллизии
</p>
<p style="text-indent: 15px; line-height: 1 em;"> В случае сбоя команды будет выведено соответствующее сообщение, при этом добавления элементов в цепь не произойдет. </p>
<p align='center'>
<img alt='D 05 13' src='/upload/ru/docs/3dsd/v1/p-marking/d-05-img/d-05-13.png' />
<br/>
Рис. 13. Сообщение о сбое
</p>
